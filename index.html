<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>首页</title>
  <link rel="stylesheet" href="./bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/index.css">
  <link rel="stylesheet" href="./css/swiper.min.css">
</head>
<body>
  <div class="container-fluid-home">
    <div class="videos">
      <video id="video0" src="./videos/first.mp4" style="display: block;">
        您的浏览器不支持video标签，请升级浏览器再浏览本页面！<a href="./videos/first.mp4">视频地址</a>
      </video>
      <video src="./videos/second.mp4" id="video1">
        您的浏览器不支持video标签，请升级浏览器再浏览本页面！<a href="./videos/second.mp4">视频地址</a>
      </video>
    </div>
    <div class="swiper-container-wrapper">
      <!-- Swiper -->
      <div class="swiper-container">
        <div class="swiper-wrapper">
          <div class="swiper-slide">
            <div class="first swiper-img">
              <img src="./images/first.jpg" width="100%" alt="">
            </div>
          </div>
        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination"></div>
      </div>
    </div>

  </div>
  <nav class="navbar navbar-shell navbar-fixed-bottom">
    <div class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand navbar-brand-shell" href="./index.html">浙江壳牌燃油有限公司</a>
      </div>
      <!-- Collect the nav links -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
          <li class="active">
            <a href="./index.html">
              <div>
                <p>HOME</p>
                <p>首页</p>
              </div>
            </a>
          </li>
          <li>
            <a href="./story.html">
              <div>
                <p>STORY</p>
                <p>我们的故事</p>
              </div>
            </a>
          </li>
          <li class="dropdown">
            <a href="./here.html" class="dropdown-toggle" >
              <div>
                <p>NEWS</p>
                <p>资讯在浙里</p>
              </div>
                <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
              <li><a href="./activities.html">最新活动</a></li>
              <li><a href="./news.html">壳牌洞察</a></li>
              <li><a href="./oilsitemap.html">油站分布</a></li>
            </ul>
          </li>
          <li>
            <a href="./product.html">
              <div>
                <p>PRODUCT</p>
                <p>产品与服务</p>
              </div>
            </a>
          </li>
          <li>
            <a href="./about.html">
              <div>
                <p>CAREERS</p>
                <p>壳动人才</p>
              </div>
            </a>
          </li>
          <li>
            <a href="./questions.html">
              <div>
                <p>Q&A</p>
                <p>问题与回答</p>
              </div>
            </a>
          </li>
          <li>
            <a href="./map.html">
              <div>
                <p>MAP</p>
                <p>地图分布</p>
              </div>
            </a>
          </li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
  </nav>
  <script src="./js/jquery.min-1.12.1.js"></script>
  <script src="./bootstrap/js/bootstrap.min.js"></script>
  <script src="./js/swiper.jquery.min.js"></script>
  <script>
    $(function(){

      var getVideoCanPlay = function (video){
        return new Promise(resolve => {
          console.log('readyState', video.readyState);
          if(!video.readyState){
            video.oncanplay = () => {
              // console.log('play')
              resolve(video)
            }
          }else {
            resolve(video)
          }

        })
      }


      var prevSlideIndex = 0;
      var video1EndMonitor = null;
      var swiper = new Swiper('.swiper-container', {
        pagination: '.swiper-pagination',
        direction: 'vertical',
        slidesPerView: 1,
        paginationClickable: true,
        spaceBetween: 30,
        mousewheelControl: true,
        effect: 'fade',
        fade: {crossFade: true},
        onInit: function (){
          var video0 = document.getElementById('video0');
          var video1 = document.getElementById('video1');
          getVideoCanPlay(video0).then((video) => {
            video.play();
          })
          video0EndMonitor = setInterval(() => {
            if(video0.ended) {
              // 视频播放结束
              console.log(video0.ended)
              $('.first').addClass('end').removeClass('start');
              video0EndMonitor && clearInterval(video0EndMonitor);
              video0EndMonitor = null;
              video0.style.display = 'none';
              video1.style.display = 'block';
            }
          })
        },
        onSlideChangeEnd: function(swiper){
          // console.log(swiper)
          // console.log(swiper.activeIndex) //切换结束时，告诉我现在是第几个slide
          // console.log(swiper.activeIndex - prevSlideIndex > 0)
          if(swiper.activeIndex - prevSlideIndex > 0){
            // 正序
            var nextVideo = document.getElementById('video' + swiper.activeIndex);
            var prevVideo = document.getElementById('video' + prevSlideIndex);
            getVideoCanPlay(nextVideo).then(video => {
              video.play();
            })
          }else {
            // 倒序
          }
          prevSlideIndex = swiper.activeIndex;
        }
      });
    })
  </script>
</body>
</html>
